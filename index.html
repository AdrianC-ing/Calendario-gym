<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Calendario simple — Notas por día</title>
  <style>
    :root{
      --bg:#0f172a; --panel:#111827; --card:#0b1324; --line:#1f2937;
      --text:#e5e7eb; --muted:#94a3b8; --accent:#22c55e;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:ui-sans-serif,system-ui,Segoe UI,Roboto; background:var(--bg); color:var(--text);}
    .wrap{max-width:980px; margin:24px auto; padding:0 16px;}
    header{display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;}
    h1{font-size:20px; margin:0;}
    .panel{background:var(--panel); border:1px solid var(--line); border-radius:14px; padding:16px;}
    .grid{display:grid; grid-template-columns:repeat(7,1fr); gap:8px;}
    .dow{ text-align:center; color:var(--muted); font-weight:700; font-size:12px; letter-spacing:.5px; text-transform:uppercase;}
    .day{background:var(--card); border:1px solid var(--line); border-radius:12px; padding:8px; min-height:110px; display:flex; flex-direction:column; gap:6px;}
    .num{font-size:12px; color:var(--muted);}
    .note-preview{font-size:13px; line-height:1.3; white-space:pre-wrap;}
    .edit{margin-top:auto; font-size:12px; color:var(--muted); cursor:pointer; align-self:flex-end;}
    .textarea{width:100%; min-height:70px; resize:vertical; border-radius:8px; border:1px solid var(--line); background:#0a1325; color:var(--text); padding:8px;}
    .hidden{display:none;}
    .help{color:var(--muted); font-size:13px; margin-top:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 id="label">Mes YYYY</h1>
    </header>

    <div class="panel">
      <div class="grid" id="head"></div>
      <div class="grid" id="days"></div>
      <p class="help">Clic en “Editar” para escribir qué hiciste ese día. Se guarda automáticamente.</p>
    </div>
  </div>

  <script>
    // ---- utilidades de fecha
    const DOW = ["Lun","Mar","Mié","Jue","Vie","Sáb","Dom"];
    const today = new Date();
    let view = new Date(today.getFullYear(), today.getMonth(), 1); // mes actual

    const el = {
      head: document.getElementById('head'),
      days: document.getElementById('days'),
      label: document.getElementById('label')
    };

    // dibuja cabecera de días (L..D)
    function buildHead(){
      el.head.innerHTML = '';
      for (const d of DOW){
        const div = document.createElement('div');
        div.className = 'dow';
        div.textContent = d;
        el.head.appendChild(div);
      }
    }

    // clave de almacenamiento por mes
    function monthKey(d=view){
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      return `${y}-${m}`;
    }
    function loadMonth(){
      try { return JSON.parse(localStorage.getItem('cal.notes.'+monthKey())) || {}; }
      catch { return {}; }
    }
    function saveMonth(data){
      localStorage.setItem('cal.notes.'+monthKey(), JSON.stringify(data));
    }

    function render(){
      // etiqueta mes
      const label = new Intl.DateTimeFormat('es-ES',{month:'long', year:'numeric'}).format(view);
      el.label.textContent = label.charAt(0).toUpperCase()+label.slice(1);

      // grid de días
      el.days.innerHTML = '';
      const y = view.getFullYear(), m = view.getMonth();
      const first = new Date(y,m,1);
      const start = (first.getDay()+6)%7; // lunes=0
      const dim = new Date(y,m+1,0).getDate();
      const notes = loadMonth();

      // huecos iniciales
      for (let i=0;i<start;i++){
        const blank = document.createElement('div');
        blank.className = 'day'; blank.style.visibility='hidden';
        el.days.appendChild(blank);
      }

      // días del mes
      for (let d=1; d<=dim; d++){
        const cell = document.createElement('div');
        cell.className = 'day';
        const num = document.createElement('div');
        num.className = 'num'; num.textContent = d;
        const prev = document.createElement('div');
        prev.className = 'note-preview';
        prev.textContent = notes[d] || '';
        const edit = document.createElement('div');
        edit.className = 'edit'; edit.textContent = 'Editar';

        // editor (oculto por defecto)
        const ta = document.createElement('textarea');
        ta.className = 'textarea hidden';
        ta.value = notes[d] || '';

        // eventos
        edit.onclick = () => {
          const opened = !ta.classList.contains('hidden');
          // alternar
          ta.classList.toggle('hidden', opened);
          if (!opened) ta.focus();
        };
        ta.oninput = () => {
          const month = loadMonth();
          month[d] = ta.value.trim();
          saveMonth(month);
          prev.textContent = month[d];
        };

        cell.appendChild(num);
        cell.appendChild(prev);
        cell.appendChild(ta);
        cell.appendChild(edit);
        el.days.appendChild(cell);
      }
    }

    // iniciar
    buildHead();
    render();
  </script>
</body>
</html>
